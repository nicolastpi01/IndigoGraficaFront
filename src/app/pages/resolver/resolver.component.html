
<!--div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 32 }"></div-->
<button nz-button class="borrar" nzType="primary" nzDanger>Borrar<i nz-icon nzType="delete" nzTheme="outline"></i></button>
<br>
<br>
<nz-collapse  nzAccordion>
  <nz-collapse-panel *ngFor="let panel of panels" [nzHeader]="panel.name" [nzActive]="panel.active">
    <ng-template [ngIf]="panel.name === 'Datos' " [ngIfElse]="ifElse">
    <div nz-col class="gutter-row">
      <div class="inner-box">
          <nz-descriptions nzTitle="Pedido" nzBordered >
              <nz-descriptions-item nzTitle="Nombre">{{ currentPedido?.nombre }}</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Billing Mode">Prepaid</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Automatic Renewal">YES</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Order Time">2018-04-24 18:00:00</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Usage Time" [nzSpan]="2">
                2018-04-24 18:00:00 To 2019-04-24 18:00:00
              </nz-descriptions-item>
              <nz-descriptions-item nzTitle="Status" [nzSpan]="3">
                <nz-badge nzStatus="processing" nzText="Running"></nz-badge>
              </nz-descriptions-item>
              <nz-descriptions-item nzTitle="Negotiated Amount">$80.00</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Discount">$20.00</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Official Receipts">$60.00</nz-descriptions-item>
              <nz-descriptions-item nzTitle="Config Info">
                Data disk type: MongoDB
                <br />
                Database version: 3.4
                <br />
                Package: dds.mongo.mid
                <br />
                Storage space: 10 GB
                <br />
                Replication_factor:3
                <br />
                Region: East China 1
              </nz-descriptions-item>
            </nz-descriptions>
      </div>
    </div>
     </ng-template>

     <ng-template #ifElse>
     <ng-template [ngIf]="panel.name === 'Files' " [ngIfElse]="Solucion">
      <div nz-col class="gutter-row" [nzSpan]="16">
        <div>
            col-16
            <nz-list nzGrid>
                <div nz-row [nzGutter]="16" *ngIf="currentPedido && currentPedido.files">
                  <div nz-col [nzSpan]="6" *ngFor="let file of currentPedido.files">
                    <nz-list-item>
                      <nz-card [nzCover]="coverTemplate" [nzActions]="[actionAddComment]">
                          <nz-card-meta
                              [nzTitle]="file.name"
                              nzDescription=""
                              [nzAvatar]="avatarTemplate"
                          ></nz-card-meta>
                            <ng-template #avatarTemplate>
                            </ng-template>
                            <ng-template #coverTemplate>
                              <img nz-image alt="no cargo imagen" *ngIf="file && file.url" [nzSrc]="file.url" [ngStyle]="{ width: '100%', height: '140px', cursor: 'pointer' }">
                            </ng-template>
                            <ng-template #actionAddComment>
                              <i nz-icon nzType="comment" (click)="onClickComment($event, file)" nzTheme="outline"></i>
                            </ng-template>
                      </nz-card>
                    </nz-list-item>
                  </div>
                </div>
            </nz-list>
        </div>

        <nz-modal
              [(nzVisible)]="isVisibleModalComment"
              [nzBodyStyle]="{ minHeight: '600px' }"
              nzWidth="100%"
              nzTitle="Resolver"
              nzCentered
              (nzOnCancel)="handleCancelResolver()"
              (nzOnOk)="handleOkResolver()"
            >
              <ng-container *nzModalContent>
                  <div nz-row  [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 32 }" >
                    <div nz-col nzSpan="16" style="position: relative;" >
                      <img nz-image nzDisablePreview *ngIf="currentFile && currentFile.url" [nzSrc]="currentFile.url" [ngStyle]="{ width: '1220px', height: '100%'}">
                      <div *ngIf="currentFile && currentFile.comentarios">
                        <div *ngFor="let item of currentFile.comentarios">
                          <nz-badge
                            [nzCount]="item.numero"
                            [style]="badgeUponImagePositionStyle(item)">
                          </nz-badge>
                        </div>
                      </div>
                    </div>
                    <div nz-col nzSpan="8" >
                      <cdk-virtual-scroll-viewport itemSize="10" class="demo-infinite-container">
                      <nz-list *ngIf="currentFile && currentFile.comentarios">
                        <nz-list-item *cdkVirtualFor="let item of currentFile.comentarios">
                          <nz-comment [nzAuthor]="item.rol" [nzDatetime]="now">
                            <nz-avatar
                              nz-comment-avatar
                              [textContent]="item.numero"
                              nzSize="large"
                              [style]="badgeColorStyle()"
                            ></nz-avatar>
                            <nz-comment-content>
                            <p
                              nz-typography
                              nzEllipsis
                              nzExpandable
                              nzCopyable 
                              [nzCopyTooltips]="null"
                              [attr.title]="content"
                              [nzEllipsisRows]="1"
                              [nzContent]="content"
                            >
                            </p>
                            <div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 32, xl: 32, xxl: 32 } ">
                              <div nz-col>
                                <div nz-row [nzGutter]="8" (click)="onClickChat($event, item)" style="cursor: pointer;">
                                  <div nz-col>
                                      <!--strong>Ir al chat</strong-->
                                      <span nz-typography nzType="secondary">Ir al chat</span>
                                  </div>
                                  <div nz-col>
                                    <span nz-typography nzType="secondary"><i nz-icon nzType="message" nzTheme="outline"></i></span>
                                  </div>
                                </div>
                              </div>
                              <div nz-col>
                                <label nz-checkbox [(ngModel)]="item.terminado" (ngModelChange)="onChangeCheck($event, item)">
                                  <!--strong>{{ item.terminado ? 'Finalizado' : 'Marcar como finalizado' }}</strong-->
                                  <span nz-typography nzType="secondary">{{ item.terminado ? 'Finalizado' : 'Marcar como finalizado' }}</span>
                                </label>
                              </div>
                            </div>
                            </nz-comment-content>
                          </nz-comment> 
                        </nz-list-item>
                      </nz-list>
                      </cdk-virtual-scroll-viewport>
                    </div>
                  </div>
              </ng-container>
          </nz-modal> 
      </div>
            <nz-modal
              [(nzVisible)]="isVisibleModalChat"
              [nzBodyStyle]="{ minHeight: '600px' }"
              nzWidth="50%"
              nzTitle="Chat"
              nzCentered
              (nzOnCancel)="handleCancelChat()"
              (nzOnOk)="handleOkChat()"
            >
              <ng-container *nzModalContent>
                      <!--cdk-virtual-scroll-viewport itemSize="10" class="demo-infinite-container"-->
                      <nz-list *ngIf="currentComment && currentComment.interacciones">
                        <nz-list-item *ngFor="let item of currentComment.interacciones">
                          <nz-comment [nzAuthor]="item.rol" [nzDatetime]="time">
                            <nz-avatar
                              nz-comment-avatar
                              [nzIcon]="determineIcon(item)"
                              [style]="avatarStyle(item)"
                            ></nz-avatar>
                            <nz-comment-content>
                            <p
                              nz-typography
                              nzEllipsis
                              nzExpandable
                              nzCopyable 
                              [nzCopyTooltips]="null"
                              [attr.title]="content"
                              [nzEllipsisRows]="2"
                              [nzContent]="content"
                            >
                            </p>
                            </nz-comment-content>
                            <nz-comment-action *ngIf="sePuedeResponder(item)"><a (click)="responderInteraccion($event, item)">Responder</a></nz-comment-action>
                          </nz-comment>                
                        </nz-list-item>
                      </nz-list>
                      <!--/cdk-virtual-scroll-viewport-->
              </ng-container>
            </nz-modal>
            
            <nz-modal
              [(nzVisible)]="isVisibleModalResponse"
              [nzBodyStyle]="{ minHeight: '600px' }"
              nzWidth="50%"
              nzTitle="Respuesta"
              nzCentered
              (nzOnCancel)="handleCancelModalResponse()"
              (nzOnOk)="handleOkModalResponse()"
            >
              <ng-container *nzModalContent>         
                <nz-comment *ngIf="interaccionForResponse" [nzAuthor]="interaccionForResponse.rol" [nzDatetime]="time">
                  <nz-avatar
                    nz-comment-avatar
                    [nzIcon]="determineIcon(interaccionForResponse)"
                    [style]="avatarStyle(interaccionForResponse)"
                  ></nz-avatar>
                  <nz-comment-content>
                    <p
                      nz-typography
                      nzEllipsis
                      nzExpandable
                      nzCopyable 
                      [nzCopyTooltips]="null"
                      [attr.title]="content"
                      [nzEllipsisRows]="2"
                      [nzContent]="content"
                    >
                    </p>
                  </nz-comment-content>
                </nz-comment>

                <nz-comment [nzAuthor]="interaccionResponse.rol" [nzDatetime]="time">
                  <nz-avatar nz-comment-avatar nzIcon="highlight" style="background-color: #f56a00"></nz-avatar>
                  <nz-comment-content>
                    <nz-form-item>
                        <textarea 
                          [disabled]="disabledResponseTextArea" 
                          (ngModelChange)="onChangeTextArea($event)" 
                          [(ngModel)]="interaccionResponse.texto" nz-input rows="5">
                        </textarea>
                    </nz-form-item>
                    <nz-form-item>
                      <button nz-button nzType="primary" (click)="setHabilitarRespuesta()">
                        {{ disabledResponseTextArea ?  'Habilitar respuesta' : 'Deshabilitar respuesta' }}
                      </button>
                    </nz-form-item>
                  </nz-comment-content>
                </nz-comment>
                
              </ng-container>
            </nz-modal> 
     </ng-template>
    </ng-template>

     <ng-template #Solucion>
      <div nz-col class="gutter-row"  [nzSpan]="6">
        <div class="inner-box">
            col-6
            <div class="clearfix">
                <nz-upload
                  nzAction="https://www.mocky.io/v2/5cc8019d300000980a055e76"
                  nzListType="picture"
                  [(nzFileList)]="fileList1"
                >
                  <button nz-button>
                    <i nz-icon nzType="upload"></i>
                    Upload
                  </button>
                </nz-upload>
            </div>
        </div>
      </div>
     </ng-template>
  </nz-collapse-panel>
</nz-collapse>
<br>

<div nz-row class="buttonGroup" [nzGutter]="16">
  <div nz-col><button nz-button nzType="default" style="width: 120px;">Salir<i nz-icon nzType="home" nzTheme="outline"></i></button></div>
  <div nz-col><button nz-button nzType="primary">Resolver<i nz-icon nzType="check" nzTheme="outline"></i></button></div>
</div>



